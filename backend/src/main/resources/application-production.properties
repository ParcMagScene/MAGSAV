# =====================================================
# MAGSAV-3.0 - Configuration PRODUCTION
# =====================================================
# Activer avec: spring.profiles.active=production

spring.application.name=MAGSAV-3.0
spring.profiles.active=production

# === VIRTUAL THREADS CONFIGURATION ===
spring.threads.virtual.enabled=true

# Configuration Tomcat
server.port=8080
server.tomcat.threads.max=500
server.tomcat.accept-count=100
server.tomcat.uri-encoding=UTF-8

# === DATABASE CONFIGURATION ===
# Configuration pour base de données fichier H2 persistante
# À remplacer par PostgreSQL/MySQL en vraie production
spring.datasource.url=jdbc:h2:file:./data/magsav;DB_CLOSE_ON_EXIT=FALSE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=${DB_USERNAME:magsav}
spring.datasource.password=${DB_PASSWORD:secure_password_here}

# Console H2 désactivée en production
spring.h2.console.enabled=false

# === JPA/HIBERNATE CONFIGURATION ===
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.defer-datasource-initialization=false
spring.jpa.show-sql=false
spring.jpa.open-in-view=false

# === SECURITY CONFIGURATION ===
app.cors.allowed-origins=${CORS_ORIGINS:https://magsav.magscene.com}

# === ENCODING CONFIGURATION ===
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# === LOGGING CONFIGURATION ===
logging.level.root=WARN
logging.level.com.magscene.magsav=INFO
logging.level.org.springframework.security=WARN
logging.level.org.springframework.web=WARN
logging.level.org.hibernate.SQL=WARN
logging.charset.console=UTF-8
logging.charset.file=UTF-8
logging.file.name=./logs/magsav.log
logging.logback.rollingpolicy.max-file-size=10MB
logging.logback.rollingpolicy.max-history=30

# === UPLOAD CONFIGURATION ===
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB
app.upload.dir=${UPLOAD_DIR:./uploads}
