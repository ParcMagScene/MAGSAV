# Configuration Spring Boot pour Java 21 et Virtual Threads
spring.application.name=MAGSAV-3.0
spring.profiles.active=development

# === VIRTUAL THREADS CONFIGURATION ===
# Active les Virtual Threads pour Spring Boot 3.2+
spring.threads.virtual.enabled=true

# Configuration Tomcat avec Virtual Threads
server.port=8080
server.tomcat.threads.max=1000
server.tomcat.accept-count=100
server.tomcat.uri-encoding=UTF-8

# === DATABASE CONFIGURATION ===
# Base de données H2 persistante sur fichier
spring.datasource.url=jdbc:h2:file:${user.home}/magsav/data/magsav;DB_CLOSE_ON_EXIT=FALSE;AUTO_RECONNECT=TRUE
spring.datasource.driverClassName=org.h2.Driver
spring.datasource.username=sa
spring.datasource.password=password

# Console H2 pour debug
spring.h2.console.enabled=true
spring.h2.console.path=/h2-console

# Configuration upload de fichiers
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=50MB
app.upload.dir=${user.home}/magsav/uploads

# === JPA/HIBERNATE CONFIGURATION ===
spring.jpa.database-platform=org.hibernate.dialect.H2Dialect
spring.jpa.hibernate.ddl-auto=update
spring.jpa.defer-datasource-initialization=true
spring.sql.init.mode=embedded
spring.sql.init.data-locations=classpath:data.sql,classpath:data-clients-contracts.sql,classpath:data-sales-installations.sql,classpath:data-vehicles.sql,classpath:data-sav.sql,classpath:data-parc-materiel.sql,classpath:data-suppliers.sql,classpath:data-material-requests.sql,classpath:data-grouped-orders.sql,classpath:data-cleanup.sql
spring.sql.init.encoding=UTF-8
spring.jpa.show-sql=true
spring.jpa.open-in-view=false

# === ENCODING CONFIGURATION ===
server.servlet.encoding.charset=UTF-8
server.servlet.encoding.enabled=true
server.servlet.encoding.force=true

# === LOGGING CONFIGURATION ===
logging.level.com.magscene.magsav=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.charset.console=UTF-8
logging.charset.file=UTF-8

# === VIRTUAL THREADS SPECIFIC ===
# Configuration des pools d'exécution
spring.task.execution.pool.core-size=10
spring.task.execution.pool.max-size=1000
spring.task.execution.pool.queue-capacity=10000
spring.task.execution.thread-name-prefix=magsav-vt-