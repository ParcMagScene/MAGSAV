<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.magsav.gui.ImageScrapingPreferencesController">
  <top>
    <Label text="PrÃ©fÃ©rences de Scraping d'Images" style="-fx-font-size: 16; -fx-font-weight: bold; -fx-padding: 10;"/>
  </top>
  
  <center>
    <ScrollPane fitToWidth="true" style="-fx-background-color: transparent;">
      <VBox spacing="15" style="-fx-padding: 20;">
        
        <!-- Section Configuration Sources -->
        <VBox spacing="10">
          <Label text="Sources de Scraping" style="-fx-font-size: 14; -fx-font-weight: bold;"/>
          <Label text="Configuration actuelle des fabricants et revendeurs pour le scraping automatique d'images." 
                 style="-fx-text-fill: #666; -fx-font-size: 12;" wrapText="true"/>
          
          <TableView fx:id="sourcesTable" prefHeight="200">
            <columns>
              <TableColumn fx:id="colSourceType" text="Type" prefWidth="80"/>
              <TableColumn fx:id="colSourceName" text="Nom" prefWidth="150"/>  
              <TableColumn fx:id="colSourceUrl" text="URL de Base" prefWidth="200"/>
              <TableColumn fx:id="colSourcePattern" text="Motif de Recherche" prefWidth="200"/>
              <TableColumn fx:id="colSourceEnabled" text="ActivÃ©" prefWidth="60"/>
            </columns>
            <columnResizePolicy>
              <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
            </columnResizePolicy>
          </TableView>
          
          <HBox spacing="10">
            <Button fx:id="btnAddSource" text="âž• Ajouter Source" onAction="#onAddSource"/>
            <Button fx:id="btnEditSource" text="âœï¸ Modifier" onAction="#onEditSource" disable="true"/>
            <Button fx:id="btnDeleteSource" text="âŒ Supprimer" onAction="#onDeleteSource" disable="true"/>
            <Separator orientation="VERTICAL"/>
            <Button fx:id="btnTestSource" text="ðŸ§ª Tester" onAction="#onTestSource" disable="true"/>
          </HBox>
        </VBox>
        
        <Separator/>
        
        <!-- Section ParamÃ¨tres de Scraping -->
        <VBox spacing="10">
          <Label text="ParamÃ¨tres de Scraping" style="-fx-font-size: 14; -fx-font-weight: bold;"/>
          
          <GridPane hgap="15" vgap="10">
            <columnConstraints>
              <ColumnConstraints minWidth="150"/>
              <ColumnConstraints hgrow="ALWAYS"/>
            </columnConstraints>
            
            <Label text="DÃ©lai entre requÃªtes:" GridPane.rowIndex="0" GridPane.columnIndex="0"/>
            <HBox spacing="5" GridPane.rowIndex="0" GridPane.columnIndex="1">
              <Spinner fx:id="spinnerDelay" min="1" max="30" initialValue="3" prefWidth="80"/>
              <Label text="secondes"/>
            </HBox>
            
            <Label text="Timeout des requÃªtes:" GridPane.rowIndex="1" GridPane.columnIndex="0"/>
            <HBox spacing="5" GridPane.rowIndex="1" GridPane.columnIndex="1">
              <Spinner fx:id="spinnerTimeout" min="5" max="60" initialValue="15" prefWidth="80"/>
              <Label text="secondes"/>
            </HBox>
            
            <Label text="QualitÃ© minimale:" GridPane.rowIndex="2" GridPane.columnIndex="0"/>
            <HBox spacing="5" GridPane.rowIndex="2" GridPane.columnIndex="1">
              <Spinner fx:id="spinnerMinWidth" min="100" max="1000" initialValue="300" prefWidth="80"/>
              <Label text="Ã— "/>
              <Spinner fx:id="spinnerMinHeight" min="100" max="1000" initialValue="300" prefWidth="80"/>
              <Label text="pixels"/>
            </HBox>
            
            <Label text="Dossier de tÃ©lÃ©chargement:" GridPane.rowIndex="3" GridPane.columnIndex="0"/>
            <HBox spacing="5" GridPane.rowIndex="3" GridPane.columnIndex="1">
              <TextField fx:id="txtDownloadPath" prefWidth="300" text="images/scraped/"/>
              <Button fx:id="btnBrowseDownloadPath" text="ðŸ“" onAction="#onBrowseDownloadPath"/>
            </HBox>
          </GridPane>
        </VBox>
        
        <Separator/>
        
        <!-- Section Actions en lot -->
        <VBox spacing="10">
          <Label text="Actions en Lot" style="-fx-font-size: 14; -fx-font-weight: bold;"/>
          
          <HBox spacing="10">
            <Button fx:id="btnScrapeMissing" text="ðŸ–¼ï¸ Scraper Produits sans Images" 
                    onAction="#onScrapeMissingImages" style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
            <Button fx:id="btnScrapeAll" text="ðŸ”„ Mettre Ã  Jour Toutes les Images" 
                    onAction="#onScrapeAllImages"/>
            <Button fx:id="btnViewStats" text="ðŸ“Š Statistiques" onAction="#onViewStats"/>
          </HBox>
          
          <Label fx:id="lblStats" text="" style="-fx-text-fill: #666; -fx-font-size: 12;" wrapText="true"/>
          
          <ProgressBar fx:id="progressScraping" visible="false" prefWidth="400"/>
          <Label fx:id="lblProgress" text="" visible="false" style="-fx-font-size: 12;"/>
        </VBox>
        
      </VBox>
    </ScrollPane>
  </center>
  
  <bottom>
    <HBox spacing="10" style="-fx-padding: 15; -fx-alignment: center-right;">
      <Button fx:id="btnSave" text="ðŸ’¾ Sauvegarder" onAction="#onSave" 
              style="-fx-background-color: #2196F3; -fx-text-fill: white;"/>
      <Button fx:id="btnCancel" text="âŒ Annuler" onAction="#onCancel"/>
    </HBox>
  </bottom>
</BorderPane>