<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.image.ImageView?>
<?import java.net.*?>

<AnchorPane xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.magsav.gui.MAGSAVController">
    <stylesheets>
        <URL value="@../style/app.css" />
    </stylesheets>
    <children>
        <BorderPane xmlns="http://javafx.com/javafx/11.0.1">
            <top>
                <VBox BorderPane.alignment="CENTER">
                    <children>
                        <!-- Bandeau haut avec logo/menu -->
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                            <children>
                                <MenuButton fx:id="menuButton" text="" mnemonicParsing="false">
                                    <graphic>
                                        <Label text="ðŸ› " style="-fx-font-size: 18px;" />
                                    </graphic>
                                    <items>
                                        <Menu text="OpÃ©rations">
                                            <items>
                                                <MenuItem fx:id="menuPurchases" text="Demandes de devis (Achats)" />
                                                <MenuItem fx:id="menuRma" text="Demandes de RMA" />
                                                <MenuItem fx:id="menuDocuments" text="Documents" />
                                                <MenuItem fx:id="menuPrint" text="Impressions" />
                                            </items>
                                        </Menu>
                                        <Menu text="Import / Export">
                                            <items>
                                                <MenuItem fx:id="menuImportCsv" text="Importer CSV" />
                                            </items>
                                        </Menu>
                                        <Menu text="Configuration">
                                            <items>
                                                <MenuItem fx:id="menuUsers" text="Utilisateurs" disable="true" />
                                                <MenuItem fx:id="menuAdmin" text="Administrateur" disable="true" />
                                                <MenuItem fx:id="menuCategories" text="CatÃ©gories" />
                                                <SeparatorMenuItem />
                                                <MenuItem fx:id="menuPreferences" text="PrÃ©fÃ©rencesâ€¦" />
                                            </items>
                                        </Menu>
                                    </items>
                                </MenuButton>
                                <Label style="-fx-font-size: 18px; -fx-font-weight: bold;" text="MAGSAV - Gestion des interventions" />
                                <Region HBox.hgrow="ALWAYS" />
                                <Button fx:id="btnNewProduct" text="âž• Nouveau Produit" />
                                <Button fx:id="btnNewIntervention" text="âž• Nouvelle intervention" />
                                <Button fx:id="refreshButton" style="-fx-background-color: #2196F3; -fx-text-fill: white;" text="âŸ³ Actualiser" />
                            </children>
                            <VBox.margin>
                                <Insets bottom="6.0" left="10.0" right="10.0" top="10.0" />
                            </VBox.margin>
                        </HBox>
                        <Separator />
                    </children>
                </VBox>
            </top>

            <center>
                <VBox spacing="10.0">
                    <!-- Cadre Produits -->
                    <TitledPane text="Produits" expanded="true">
                        <content>
                            <VBox spacing="6.0">
                                <padding>
                                    <Insets top="10.0" right="10.0" bottom="10.0" left="10.0" />
                                </padding>
                                <VBox spacing="6.0">
                                    <children>
                                        <HBox spacing="6.0" alignment="CENTER_LEFT">
                                            <children>
                                                <TextField fx:id="globalSearchField" HBox.hgrow="ALWAYS" promptText="Rechercher produit / SN / code / fabricant / catÃ©gorie / sous-catÃ©gorie" styleClass="search-field" />
                                                <Button fx:id="btnClearSearch" text="âœ•" visible="false" managed="false" focusTraversable="false" styleClass="clear-btn" />
                                            </children>
                                        </HBox>
                                        <ListView fx:id="globalSuggestions" visible="false" managed="false" maxHeight="160.0" />
                                        <HBox alignment="CENTER_LEFT" spacing="8.0">
                                            <children>
                                                <Region HBox.hgrow="ALWAYS" />
                                            </children>
                                        </HBox>
                                    </children>
                                </VBox>
                                <TableView fx:id="productsTable">
                                    <columns>
                                        <TableColumn fx:id="colPProduit" text="Produit" prefWidth="200" />
                                        <TableColumn fx:id="colPSn" text="NÂ° SÃ©rie" prefWidth="160" />
                                        <TableColumn fx:id="colPCount" text="Interventions" prefWidth="120" />
                                        <TableColumn fx:id="colPLastIn" text="DerniÃ¨re entrÃ©e" prefWidth="140" />
                                        <TableColumn fx:id="colPLastOut" text="DerniÃ¨re sortie" prefWidth="140" />
                                    </columns>
                                    <columnResizePolicy>
                                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                    </columnResizePolicy>
                                </TableView>
                            </VBox>
                        </content>
                    </TitledPane>

                    <!-- Cadre Interventions -->
                    <TitledPane text="Interventions" expanded="true">
                        <content>
                            <VBox spacing="6.0">
                                <padding>
                                    <Insets top="10.0" right="10.0" bottom="10.0" left="10.0" />
                                </padding>
                                <TableView fx:id="tableView">
                                    <columns>
                                        <TableColumn fx:id="colCode" prefWidth="90.0" text="Code" />
                                        <TableColumn fx:id="colId" prefWidth="60.0" text="ID" />
                                        <TableColumn fx:id="colProprietaire" prefWidth="150.0" text="PropriÃ©taire" />
                                        <TableColumn fx:id="colAppareil" prefWidth="200.0" text="Appareil" />
                                        <TableColumn fx:id="colProbleme" prefWidth="250.0" text="ProblÃ¨me" />
                                        <TableColumn fx:id="colStatut" prefWidth="100.0" text="Statut" />
                                        <TableColumn fx:id="colDateCreation" prefWidth="120.0" text="Date entrÃ©e" />
                                        <TableColumn fx:id="colDateReparation" prefWidth="120.0" text="Date sortie" />
                                    </columns>
                                    <columnResizePolicy>
                                        <TableView fx:constant="CONSTRAINED_RESIZE_POLICY" />
                                    </columnResizePolicy>
                                </TableView>
                            </VBox>
                        </content>
                    </TitledPane>
                </VBox>
            </center>

            <right>
                <VBox spacing="8.0" prefWidth="340.0" BorderPane.alignment="CENTER">
                    <padding>
                        <Insets top="10.0" right="10.0" bottom="10.0" left="0.0" />
                    </padding>
                    <children>
                        <HBox alignment="CENTER">
                            <children>
                                <Label text="AperÃ§u" style="-fx-font-size: 16px; -fx-font-weight: bold;" />
                                <Region prefWidth="10" />
                                <StackPane style="-fx-background-color: rgba(0,0,0,0.04); -fx-background-radius: 6; -fx-padding: 2; -fx-border-color: rgba(0,0,0,0.15); -fx-border-radius: 6;">
                                    <children>
                                        <ImageView fx:id="previewManufacturerLogo" fitHeight="24.0" fitWidth="80.0" preserveRatio="true" pickOnBounds="true" />
                                    </children>
                                </StackPane>
                            </children>
                        </HBox>
                        <Separator />
                        <Label fx:id="previewTitle" text="Aucune sÃ©lection" style="-fx-font-size: 14px;" wrapText="true" />
                        <Label fx:id="previewLine1" text="" wrapText="true" />
                        <Label fx:id="previewLine2" text="" wrapText="true" />
                        <Label fx:id="previewLine3" text="" wrapText="true" />
                        <Separator />
                        <HBox spacing="12.0">
                            <children>
                                <ImageView fx:id="previewPhoto" fitWidth="200.0" fitHeight="200.0" preserveRatio="true" pickOnBounds="true" />
                                <ImageView fx:id="previewQr" fitWidth="160.0" fitHeight="160.0" preserveRatio="true" pickOnBounds="true" />
                            </children>
                        </HBox>
                        <Separator />
                        <VBox spacing="6.0">
                            <children>
                                <Button fx:id="btnDownloadProductLabel" text="ï¿½ TÃ©lÃ©charger Ã©tiquette" onAction="#handleProductLabelDownload" styleClass="action-btn" />
                                <Button fx:id="btnOpenProduct" text="ðŸ“„ Ouvrir fiche produit" onAction="#handleOpenProduct" styleClass="action-btn" visible="false" managed="false" />
                                <Button fx:id="btnOpenIntervention" text="ðŸ“„ Ouvrir fiche intervention" onAction="#handleOpenIntervention" styleClass="action-btn" />
                            </children>
                        </VBox>
                    </children>
                </VBox>
            </right>

            <bottom>
                <VBox BorderPane.alignment="CENTER">
                    <children>
                        <Separator />
                        <HBox alignment="CENTER_RIGHT" spacing="10.0">
                            <children>
                                <Label fx:id="statusLabel" />
                            </children>
                            <VBox.margin>
                                <Insets bottom="8.0" left="10.0" right="10.0" top="8.0" />
                            </VBox.margin>
                        </HBox>
                    </children>
                </VBox>
            </bottom>
        </BorderPane>
    </children>
</AnchorPane>