<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>

<DialogPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.magsav.gui.dialogs.CsvImportDialog"
            prefWidth="700" prefHeight="600">
  
  <headerText>Import CSV avec suivi d√©taill√©</headerText>
  
  <content>
    <VBox spacing="12" style="-fx-padding: 16;">
      
      <!-- Section s√©lection fichier -->
      <VBox spacing="8" style="-fx-padding: 12; -fx-background-color: #f8f9fa; -fx-border-color: #dee2e6; -fx-border-radius: 4;">
        <Label text="üìÅ S√©lection du fichier" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
        <HBox spacing="8" alignment="CENTER_LEFT">
          <TextField fx:id="tfFilePath" promptText="Chemin vers le fichier CSV..." editable="false" HBox.hgrow="ALWAYS"/>
          <Button fx:id="btnChooseFile" text="Parcourir..." onAction="#onChooseFile"/>
        </HBox>
        <Label text="Formats support√©s: CSV avec s√©parateur virgule (,) ou point-virgule (;)" 
               style="-fx-text-fill: #6c757d; -fx-font-size: 11;"/>
      </VBox>
      
      <!-- Options d'import -->
      <VBox spacing="8" style="-fx-padding: 12; -fx-background-color: #f8f9fa; -fx-border-color: #dee2e6; -fx-border-radius: 4;">
        <Label text="‚öôÔ∏è Options d'import" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
        <CheckBox fx:id="cbDryRun" text="Mode simulation (aucune modification en base)" selected="false"/>
        <CheckBox fx:id="cbShowDetailedLogs" text="Afficher les logs d√©taill√©s" selected="true"/>
        <CheckBox fx:id="cbStopOnFirstError" text="Arr√™ter au premier erreur critique"/>
      </VBox>
      
      <!-- Progression -->
      <VBox spacing="8" style="-fx-padding: 12; -fx-background-color: #f8f9fa; -fx-border-color: #dee2e6; -fx-border-radius: 4;">
        <Label text="üìä Progression" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
        
        <HBox spacing="12" alignment="CENTER_LEFT">
          <Label text="Statut:"/>
          <Label fx:id="lblStatus" text="En attente..." style="-fx-font-weight: bold;"/>
          <Pane HBox.hgrow="ALWAYS"/>
          <Label fx:id="lblProgressText" text="0/0"/>
        </HBox>
        
        <ProgressBar fx:id="progressBar" prefWidth="Infinity" prefHeight="20"/>
        
        <!-- Statistiques en temps r√©el -->
        <GridPane hgap="16" vgap="4">
          <columnConstraints>
            <ColumnConstraints/>
            <ColumnConstraints/>
            <ColumnConstraints/>
            <ColumnConstraints/>
          </columnConstraints>
          
          <Label text="Lignes trait√©es:" GridPane.columnIndex="0" GridPane.rowIndex="0"/>
          <Label fx:id="lblRowsProcessed" text="0" style="-fx-font-weight: bold; -fx-text-fill: #495057;" 
                 GridPane.columnIndex="1" GridPane.rowIndex="0"/>
          
          <Label text="Produits cr√©√©s:" GridPane.columnIndex="2" GridPane.rowIndex="0"/>
          <Label fx:id="lblProductsCreated" text="0" style="-fx-font-weight: bold; -fx-text-fill: #28a745;" 
                 GridPane.columnIndex="3" GridPane.rowIndex="0"/>
          
          <Label text="Interventions:" GridPane.columnIndex="0" GridPane.rowIndex="1"/>
          <Label fx:id="lblInterventionsCreated" text="0" style="-fx-font-weight: bold; -fx-text-fill: #17a2b8;" 
                 GridPane.columnIndex="1" GridPane.rowIndex="1"/>
          
          <Label text="Erreurs:" GridPane.columnIndex="2" GridPane.rowIndex="1"/>
          <Label fx:id="lblErrors" text="0" style="-fx-font-weight: bold; -fx-text-fill: #dc3545;" 
                 GridPane.columnIndex="3" GridPane.rowIndex="1"/>
        </GridPane>
      </VBox>
      
      <!-- Zone de logs -->
      <VBox spacing="8" VBox.vgrow="ALWAYS">
        <Label text="üìù Logs d'import" style="-fx-font-weight: bold; -fx-font-size: 14;"/>
        <TextArea fx:id="taLogs" editable="false" wrapText="true" VBox.vgrow="ALWAYS"
                  style="-fx-font-family: 'Courier New', monospace; -fx-font-size: 11px;"
                  promptText="Les logs d'import appara√Ætront ici en temps r√©el..."/>
      </VBox>
      
    </VBox>
  </content>
  
  <buttonTypes>
    <ButtonType fx:constant="CANCEL"/>
  </buttonTypes>
  
  <expandableContent>
    <VBox spacing="8">
      <Label text="Format CSV attendu:" style="-fx-font-weight: bold;"/>
      <Label text="Le fichier CSV doit contenir au minimum les colonnes suivantes :" wrapText="true"/>
      <VBox spacing="4" style="-fx-padding: 8; -fx-background-color: #f8f9fa;">
        <Label text="‚Ä¢ Nom du produit (produit, nom, nom_produit, designation)" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ N¬∞ de s√©rie (no_de_serie, sn, serial, numero_serie)" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ Propri√©taire (proprietaire, client, owner)" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ Description panne (panne, defaut, probleme, description)" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ Statut (status, statut, etat) - optionnel, par d√©faut 'Ouverte'" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ Date entr√©e (date_entree, entree, debut) - optionnel" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ Date sortie (date_sortie, sortie, fin) - optionnel" style="-fx-font-family: monospace;"/>
        <Label text="‚Ä¢ N¬∞ suivi (no_suivi, tracking, suivi) - optionnel" style="-fx-font-family: monospace;"/>
      </VBox>
      <Label text="La premi√®re ligne doit contenir les en-t√™tes de colonnes." wrapText="true"/>
      <Label text="S√©parateurs support√©s: virgule (,) ou point-virgule (;)" wrapText="true"/>
    </VBox>
  </expandableContent>
  
</DialogPane>