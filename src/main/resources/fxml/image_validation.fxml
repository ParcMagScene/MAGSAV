<?xml version="1.0" encoding="UTF-8"?>
<?import javafx.scene.control.*?>
<?import javafx.scene.image.*?>
<?import javafx.scene.layout.*?>

<BorderPane xmlns="http://javafx.com/javafx/21" xmlns:fx="http://javafx.com/fxml/1"
            fx:controller="com.magsav.gui.ImageValidationController">
  <top>
    <VBox spacing="10" style="-fx-padding: 15;">
      <Label text="Validation des Correspondances Images-Produits" style="-fx-font-size: 16; -fx-font-weight: bold;"/>
      <Label text="VÃ©rifiez et validez les associations automatiques entre les images scrapÃ©es et les produits." 
             style="-fx-text-fill: #666; -fx-font-size: 12;" wrapText="true"/>
      
      <HBox spacing="15" style="-fx-alignment: center-left;">
        <Label fx:id="lblStats" text="ðŸ“Š 0 correspondances Ã  valider" style="-fx-font-weight: bold;"/>
        <Separator orientation="VERTICAL"/>
        <Button fx:id="btnAutoValidateAll" text="âœ… Valider Toutes" onAction="#onAutoValidateAll" 
                style="-fx-background-color: #4CAF50; -fx-text-fill: white;"/>
        <Button fx:id="btnRejectAll" text="âŒ Rejeter Toutes" onAction="#onRejectAll"/>
        <Button fx:id="btnRefreshList" text="ðŸ”„ Actualiser" onAction="#onRefreshList"/>
      </HBox>
    </VBox>
  </top>
  
  <center>
    <SplitPane dividerPositions="0.7" style="-fx-padding: 10;">
      
      <!-- Liste des correspondances Ã  valider -->
      <VBox spacing="10">
        <Label text="Correspondances DÃ©tectÃ©es" style="-fx-font-size: 14; -fx-font-weight: bold;"/>
        
        <TableView fx:id="correspondencesTable" VBox.vgrow="ALWAYS">
          <columns>
            <TableColumn fx:id="colProductUID" text="UID Produit" prefWidth="80"/>
            <TableColumn fx:id="colProductName" text="Nom Produit" prefWidth="200"/>
            <TableColumn fx:id="colManufacturer" text="Fabricant" prefWidth="120"/>
            <TableColumn fx:id="colImageSource" text="Source Image" prefWidth="100"/>
            <TableColumn fx:id="colConfidence" text="Confiance" prefWidth="80"/>
            <TableColumn fx:id="colStatus" text="Statut" prefWidth="100"/>
            <TableColumn fx:id="colActions" text="Actions" prefWidth="120"/>
          </columns>
          <columnResizePolicy>
            <TableView fx:constant="CONSTRAINED_RESIZE_POLICY"/>
          </columnResizePolicy>
          <placeholder><Label text="Aucune correspondance Ã  valider"/></placeholder>
        </TableView>
        
        <HBox spacing="10" style="-fx-alignment: center-left;">
          <Label text="Filtres:"/>
          <ComboBox fx:id="cbFilterStatus" promptText="Tous les statuts">
            <items>
              <String fx:value="Tous"/>
              <String fx:value="En attente"/>
              <String fx:value="ValidÃ©"/>
              <String fx:value="RejetÃ©"/>
            </items>
          </ComboBox>
          <ComboBox fx:id="cbFilterSource" promptText="Toutes les sources">
            <items>
              <String fx:value="Toutes"/>
              <String fx:value="Yamaha"/>
              <String fx:value="Sony"/>
              <String fx:value="Panasonic"/>
              <String fx:value="Bose"/>
              <String fx:value="Martin"/>
              <String fx:value="Robe"/>
            </items>
          </ComboBox>
        </HBox>
      </VBox>
      
      <!-- Panneau de dÃ©tail et prÃ©visualisation -->
      <VBox spacing="15" style="-fx-padding: 10;">
        <Label text="DÃ©tails de la Correspondance" style="-fx-font-size: 14; -fx-font-weight: bold;"/>
        
        <!-- Images cÃ´te Ã  cÃ´te -->
        <HBox spacing="20" style="-fx-alignment: center;">
          <VBox spacing="5" style="-fx-alignment: center;">
            <Label text="Image ScrapÃ©e" style="-fx-font-weight: bold;"/>
            <ImageView fx:id="imgScraped" fitWidth="180" fitHeight="180" preserveRatio="true" 
                       style="-fx-border-color: #ccc; -fx-border-width: 1;"/>
            <Label fx:id="lblScrapedInfo" text="800x600 - 45 KB" style="-fx-font-size: 10; -fx-text-fill: #666;"/>
          </VBox>
          
          <VBox spacing="5" style="-fx-alignment: center;">
            <Label text="Image Produit Actuelle" style="-fx-font-weight: bold;"/>
            <ImageView fx:id="imgCurrent" fitWidth="180" fitHeight="180" preserveRatio="true" 
                       style="-fx-border-color: #ccc; -fx-border-width: 1;"/>
            <Label fx:id="lblCurrentInfo" text="Aucune image" style="-fx-font-size: 10; -fx-text-fill: #666;"/>
          </VBox>
        </HBox>
        
        <!-- Informations sur le produit -->
        <VBox spacing="8">
          <Label text="Informations Produit" style="-fx-font-weight: bold;"/>
          <GridPane hgap="10" vgap="5">
            <columnConstraints>
              <ColumnConstraints minWidth="80"/>
              <ColumnConstraints hgrow="ALWAYS"/>
            </columnConstraints>
            
            <Label text="UID:" GridPane.rowIndex="0" GridPane.columnIndex="0" style="-fx-font-weight: bold;"/>
            <Label fx:id="lblDetailUID" text="-" GridPane.rowIndex="0" GridPane.columnIndex="1"/>
            
            <Label text="Nom:" GridPane.rowIndex="1" GridPane.columnIndex="0" style="-fx-font-weight: bold;"/>
            <Label fx:id="lblDetailName" text="-" GridPane.rowIndex="1" GridPane.columnIndex="1" wrapText="true"/>
            
            <Label text="Fabricant:" GridPane.rowIndex="2" GridPane.columnIndex="0" style="-fx-font-weight: bold;"/>
            <Label fx:id="lblDetailManufacturer" text="-" GridPane.rowIndex="2" GridPane.columnIndex="1"/>
            
            <Label text="Source:" GridPane.rowIndex="3" GridPane.columnIndex="0" style="-fx-font-weight: bold;"/>
            <Label fx:id="lblDetailSource" text="-" GridPane.rowIndex="3" GridPane.columnIndex="1"/>
            
            <Label text="URL originale:" GridPane.rowIndex="4" GridPane.columnIndex="0" style="-fx-font-weight: bold;"/>
            <Label fx:id="lblDetailURL" text="-" GridPane.rowIndex="4" GridPane.columnIndex="1" wrapText="true" 
                   style="-fx-font-size: 10; -fx-text-fill: #666;"/>
          </GridPane>
        </VBox>
        
        <!-- Actions pour la correspondance sÃ©lectionnÃ©e -->
        <VBox spacing="10">
          <Label text="Actions" style="-fx-font-weight: bold;"/>
          <HBox spacing="10">
            <Button fx:id="btnValidateOne" text="âœ… Valider" onAction="#onValidateSelected" 
                    style="-fx-background-color: #4CAF50; -fx-text-fill: white;" disable="true"/>
            <Button fx:id="btnRejectOne" text="âŒ Rejeter" onAction="#onRejectSelected" disable="true"/>
            <Button fx:id="btnSkipOne" text="â­ï¸ Ignorer" onAction="#onSkipSelected" disable="true"/>
          </HBox>
          
          <Separator/>
          
          <VBox spacing="5">
            <Label text="Actions Manuelles" style="-fx-font-size: 12; -fx-font-weight: bold;"/>
            <HBox spacing="5">
              <Button fx:id="btnChooseOtherImage" text="ðŸ–¼ï¸ Choisir Autre Image" onAction="#onChooseOtherImage" 
                      disable="true" style="-fx-font-size: 10;"/>
              <Button fx:id="btnEditProduct" text="âœï¸ Modifier Produit" onAction="#onEditProduct" 
                      disable="true" style="-fx-font-size: 10;"/>
            </HBox>
          </VBox>
        </VBox>
        
        <!-- Zone de notes -->
        <VBox spacing="5">
          <Label text="Notes" style="-fx-font-weight: bold;"/>
          <TextArea fx:id="txtNotes" promptText="Commentaires sur cette correspondance..." 
                    prefRowCount="3" wrapText="true"/>
        </VBox>
      </VBox>
      
    </SplitPane>
  </center>
  
  <bottom>
    <HBox spacing="15" style="-fx-padding: 15; -fx-alignment: center-right;">
      <Label fx:id="lblProgress" text=""/>
      <Separator orientation="VERTICAL"/>
      <Button fx:id="btnSaveValidations" text="ðŸ’¾ Appliquer les Validations" onAction="#onSaveValidations" 
              style="-fx-background-color: #2196F3; -fx-text-fill: white; -fx-font-weight: bold;"/>
      <Button fx:id="btnClose" text="Fermer" onAction="#onClose"/>
    </HBox>
  </bottom>
</BorderPane>