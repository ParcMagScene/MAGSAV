<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.*?>
<?import javafx.scene.layout.*?>
<?import javafx.scene.text.*?>

<BorderPane xmlns="http://javafx.com/javafx/17.0.2-ea" xmlns:fx="http://javafx.com/fxml/1" fx:controller="com.magsav.gui.PlanificationController">
   <top>
      <VBox spacing="10.0">
         <children>
            <!-- En-tÃªte -->
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <children>
                  <Label text="Planification des Interventions">
                     <font>
                        <Font name="System Bold" size="24.0" />
                     </font>
                  </Label>
                  <Region HBox.hgrow="ALWAYS" />
                  <Button fx:id="btnSyncGoogle" mnemonicParsing="false" onAction="#onSyncGoogle" style="-fx-background-color: #4285f4; -fx-text-fill: white;" text="ðŸ”„ Sync Google" />
                  <Button fx:id="btnNouvelleIntervention" mnemonicParsing="false" onAction="#onNouvelleIntervention" style="-fx-background-color: #28a745; -fx-text-fill: white;" text="âž• Nouvelle Intervention">
                     <font>
                        <Font name="System Bold" size="12.0" />
                     </font>
                  </Button>
               </children>
            </HBox>
            
            <!-- Barre d'outils -->
            <HBox alignment="CENTER_LEFT" spacing="10.0">
               <children>
                  <Label text="Vue:" />
                  <ToggleGroup fx:id="toggleGroupVue" />
                  <RadioButton fx:id="rbVueJour" mnemonicParsing="false" selected="true" text="Jour" toggleGroup="$toggleGroupVue" />
                  <RadioButton fx:id="rbVueSemaine" mnemonicParsing="false" text="Semaine" toggleGroup="$toggleGroupVue" />
                  <RadioButton fx:id="rbVueMois" mnemonicParsing="false" text="Mois" toggleGroup="$toggleGroupVue" />
                  
                  <Separator orientation="VERTICAL" />
                  
                  <Button fx:id="btnPrecedent" mnemonicParsing="false" onAction="#onPrecedent" text="â—€" />
                  <Label fx:id="lblPeriodeActuelle" text="Octobre 2025">
                     <font>
                        <Font name="System Bold" size="14.0" />
                     </font>
                  </Label>
                  <Button fx:id="btnSuivant" mnemonicParsing="false" onAction="#onSuivant" text="â–¶" />
                  <Button fx:id="btnAujourdhui" mnemonicParsing="false" onAction="#onAujourdhui" text="Aujourd'hui" />
                  
                  <Separator orientation="VERTICAL" />
                  
                  <Label text="Technicien:" />
                  <ComboBox fx:id="cbFiltreTechnicien" prefWidth="150.0" promptText="Tous" />
                  
                  <Label text="Statut:" />
                  <ComboBox fx:id="cbFiltreStatut" prefWidth="120.0" promptText="Tous" />
                  
                  <Button fx:id="btnFiltrer" mnemonicParsing="false" onAction="#onAppliquerFiltres" text="Filtrer" />
                  
                  <Region HBox.hgrow="ALWAYS" />
                  
                  <Button fx:id="btnActualiser" mnemonicParsing="false" onAction="#onActualiser" text="ðŸ”„" />
               </children>
            </HBox>
            
            <!-- Statistiques du jour -->
            <HBox alignment="CENTER_LEFT" spacing="20.0" style="-fx-background-color: #f8f9fa; -fx-padding: 10; -fx-background-radius: 5;">
               <children>
                  <VBox alignment="CENTER">
                     <children>
                        <Label fx:id="lblInterventionsJour" text="0" textFill="#495057">
                           <font>
                              <Font name="System Bold" size="18.0" />
                           </font>
                        </Label>
                        <Label text="Interventions Jour" textFill="#6c757d">
                           <font>
                              <Font size="11.0" />
                           </font>
                        </Label>
                     </children>
                  </VBox>
                  
                  <Separator orientation="VERTICAL" />
                  
                  <VBox alignment="CENTER">
                     <children>
                        <Label fx:id="lblTechniciensOccupes" text="0" textFill="#fd7e14">
                           <font>
                              <Font name="System Bold" size="18.0" />
                           </font>
                        </Label>
                        <Label text="Techniciens OccupÃ©s" textFill="#6c757d">
                           <font>
                              <Font size="11.0" />
                           </font>
                        </Label>
                     </children>
                  </VBox>
                  
                  <Separator orientation="VERTICAL" />
                  
                  <VBox alignment="CENTER">
                     <children>
                        <Label fx:id="lblVehiculesUtilises" text="0" textFill="#17a2b8">
                           <font>
                              <Font name="System Bold" size="18.0" />
                           </font>
                        </Label>
                        <Label text="VÃ©hicules UtilisÃ©s" textFill="#6c757d">
                           <font>
                              <Font size="11.0" />
                           </font>
                        </Label>
                     </children>
                  </VBox>
                  
                  <Separator orientation="VERTICAL" />
                  
                  <VBox alignment="CENTER">
                     <children>
                        <Label fx:id="lblInterventionsUrgentes" text="0" textFill="#dc3545">
                           <font>
                              <Font name="System Bold" size="18.0" />
                           </font>
                        </Label>
                        <Label text="Urgentes" textFill="#6c757d">
                           <font>
                              <Font size="11.0" />
                           </font>
                        </Label>
                     </children>
                  </VBox>
               </children>
            </HBox>
         </children>
         <padding>
            <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
         </padding>
      </VBox>
   </top>
   
   <center>
      <TabPane fx:id="tabPane" tabClosingPolicy="UNAVAILABLE" styleClass="dark-tab-pane">
         <tabs>
            <!-- Onglet Calendrier -->
            <Tab text="ðŸ“… Calendrier">
               <content>
                  <BorderPane>
                     <left>
                        <!-- Panneau latÃ©ral avec techniciens et vÃ©hicules -->
                        <VBox spacing="10.0" style="-fx-background-color: #f8f9fa; -fx-padding: 10;" BorderPane.alignment="CENTER">
                           <children>
                              <Label text="Ressources">
                                 <font>
                                    <Font name="System Bold" size="14.0" />
                                 </font>
                              </Label>
                              
                              <!-- Techniciens disponibles -->
                              <VBox spacing="5.0">
                                 <children>
                                    <Label text="Techniciens:" textFill="#495057">
                                       <font>
                                          <Font name="System Bold" size="12.0" />
                                       </font>
                                    </Label>
                                    <ListView fx:id="listTechniciens" maxHeight="150.0" prefHeight="150.0" />
                                 </children>
                              </VBox>
                              
                              <!-- VÃ©hicules disponibles -->
                              <VBox spacing="5.0">
                                 <children>
                                    <Label text="VÃ©hicules:" textFill="#495057">
                                       <font>
                                          <Font name="System Bold" size="12.0" />
                                       </font>
                                    </Label>
                                    <ListView fx:id="listVehicules" maxHeight="150.0" prefHeight="150.0" />
                                 </children>
                              </VBox>
                              
                              <!-- LÃ©gende -->
                              <VBox spacing="5.0">
                                 <children>
                                    <Label text="LÃ©gende:" textFill="#495057">
                                       <font>
                                          <Font name="System Bold" size="12.0" />
                                       </font>
                                    </Label>
                                    <HBox spacing="5.0">
                                       <children>
                                          <Label style="-fx-background-color: #28a745; -fx-text-fill: white; -fx-padding: 2 6; -fx-background-radius: 3;" text="âœ“" />
                                          <Label text="TerminÃ©e" textFill="#6c757d" />
                                       </children>
                                    </HBox>
                                    <HBox spacing="5.0">
                                       <children>
                                          <Label style="-fx-background-color: #007bff; -fx-text-fill: white; -fx-padding: 2 6; -fx-background-radius: 3;" text="â—" />
                                          <Label text="En cours" textFill="#6c757d" />
                                       </children>
                                    </HBox>
                                    <HBox spacing="5.0">
                                       <children>
                                          <Label style="-fx-background-color: #ffc107; -fx-text-fill: white; -fx-padding: 2 6; -fx-background-radius: 3;" text="â³" />
                                          <Label text="PlanifiÃ©e" textFill="#6c757d" />
                                       </children>
                                    </HBox>
                                    <HBox spacing="5.0">
                                       <children>
                                          <Label style="-fx-background-color: #dc3545; -fx-text-fill: white; -fx-padding: 2 6; -fx-background-radius: 3;" text="!" />
                                          <Label text="Urgente" textFill="#6c757d" />
                                       </children>
                                    </HBox>
                                 </children>
                              </VBox>
                           </children>
                        </VBox>
                     </left>
                     
                     <center>
                        <!-- Zone principale du calendrier -->
                        <VBox spacing="10.0">
                           <children>
                              <!-- En-tÃªte du calendrier avec heures (pour vue jour/semaine) -->
                              <ScrollPane fx:id="scrollCalendrier" fitToWidth="true" VBox.vgrow="ALWAYS">
                                 <content>
                                    <VBox fx:id="vboxCalendrier" spacing="1.0" />
                                 </content>
                              </ScrollPane>
                           </children>
                           <padding>
                              <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                           </padding>
                        </VBox>
                     </center>
                  </BorderPane>
               </content>
            </Tab>
            
            <!-- Onglet Liste des interventions -->
            <Tab text="ðŸ“‹ Liste des Interventions">
               <content>
                  <VBox spacing="10.0">
                     <children>
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                           <children>
                              <Label text="Recherche:" />
                              <TextField fx:id="txtRechercheIntervention" prefWidth="200.0" promptText="NÂ° intervention, client..." />
                              <Button fx:id="btnRechercherIntervention" mnemonicParsing="false" onAction="#onRechercherIntervention" text="ðŸ”" />
                              
                              <Separator orientation="VERTICAL" />
                              
                              <DatePicker fx:id="dpDateDebut" promptText="Date dÃ©but" />
                              <Label text="Ã " />
                              <DatePicker fx:id="dpDateFin" promptText="Date fin" />
                              
                              <Region HBox.hgrow="ALWAYS" />
                              
                              <Button fx:id="btnExporterPlanning" mnemonicParsing="false" onAction="#onExporterPlanning" text="ðŸ“„ Exporter" />
                           </children>
                        </HBox>
                        
                        <TableView fx:id="tableInterventions" prefHeight="400.0" VBox.vgrow="ALWAYS">
                           <columns>
                              <TableColumn fx:id="colInterventionNumero" prefWidth="100.0" text="NÂ° Inter." />
                              <TableColumn fx:id="colInterventionClient" prefWidth="150.0" text="Client" />
                              <TableColumn fx:id="colInterventionDate" prefWidth="100.0" text="Date" />
                              <TableColumn fx:id="colInterventionHeure" prefWidth="80.0" text="Heure" />
                              <TableColumn fx:id="colInterventionTechnicien" prefWidth="120.0" text="Technicien" />
                              <TableColumn fx:id="colInterventionVehicule" prefWidth="100.0" text="VÃ©hicule" />
                              <TableColumn fx:id="colInterventionStatut" prefWidth="100.0" text="Statut" />
                              <TableColumn fx:id="colInterventionPriorite" prefWidth="80.0" text="PrioritÃ©" />
                              <TableColumn fx:id="colInterventionActions" prefWidth="100.0" text="Actions" />
                           </columns>
                        </TableView>
                        
                        <!-- Actions pour l'intervention sÃ©lectionnÃ©e -->
                        <HBox alignment="CENTER_LEFT" spacing="10.0" style="-fx-background-color: #e9ecef; -fx-padding: 10; -fx-background-radius: 5;">
                           <children>
                              <Label text="Actions pour l'intervention sÃ©lectionnÃ©e:" />
                              <Region HBox.hgrow="ALWAYS" />
                              <Button fx:id="btnVoirIntervention" disable="true" mnemonicParsing="false" onAction="#onVoirIntervention" text="ðŸ‘ Voir" />
                              <Button fx:id="btnModifierIntervention" disable="true" mnemonicParsing="false" onAction="#onModifierIntervention" text="âœï¸ Modifier" />
                              <Button fx:id="btnReplanifier" disable="true" mnemonicParsing="false" onAction="#onReplanifier" text="ðŸ“… Replanifier" />
                              <Button fx:id="btnAnnulerIntervention" disable="true" mnemonicParsing="false" onAction="#onAnnulerIntervention" style="-fx-background-color: #dc3545; -fx-text-fill: white;" text="âŒ Annuler" />
                           </children>
                        </HBox>
                     </children>
                     <padding>
                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                     </padding>
                  </VBox>
               </content>
            </Tab>
            
            <!-- Onglet Gestion des techniciens -->
            <Tab text="ðŸ‘¨â€ðŸ”§ Techniciens">
               <content>
                  <VBox spacing="10.0">
                     <children>
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                           <children>
                              <Label text="Gestion des Techniciens">
                                 <font>
                                    <Font name="System Bold" size="16.0" />
                                 </font>
                              </Label>
                              <Region HBox.hgrow="ALWAYS" />
                              <Button fx:id="btnNouveauTechnicien" mnemonicParsing="false" onAction="#onNouveauTechnicien" style="-fx-background-color: #28a745; -fx-text-fill: white;" text="âž• Nouveau Technicien" />
                           </children>
                        </HBox>
                        
                        <TableView fx:id="tableTechniciens" prefHeight="300.0">
                           <columns>
                              <TableColumn fx:id="colTechnicienNom" prefWidth="120.0" text="Nom" />
                              <TableColumn fx:id="colTechnicienPrenom" prefWidth="120.0" text="PrÃ©nom" />
                              <TableColumn fx:id="colTechnicienEmail" prefWidth="180.0" text="Email" />
                              <TableColumn fx:id="colTechnicienTelephone" prefWidth="120.0" text="TÃ©lÃ©phone" />
                              <TableColumn fx:id="colTechnicienSpecialites" prefWidth="200.0" text="SpÃ©cialitÃ©s" />
                              <TableColumn fx:id="colTechnicienStatut" prefWidth="100.0" text="Statut" />
                              <TableColumn fx:id="colTechnicienGoogle" prefWidth="80.0" text="Google" />
                              <TableColumn fx:id="colTechnicienActions" prefWidth="100.0" text="Actions" />
                           </columns>
                        </TableView>
                        
                        <HBox alignment="CENTER_LEFT" spacing="10.0">
                           <children>
                              <Button fx:id="btnModifierTechnicien" disable="true" mnemonicParsing="false" onAction="#onModifierTechnicien" text="âœï¸ Modifier" />
                              <Button fx:id="btnDisponibilitesTechnicien" disable="true" mnemonicParsing="false" onAction="#onDisponibilitesTechnicien" text="ðŸ“… DisponibilitÃ©s" />
                              <Button fx:id="btnSyncGoogleTechnicien" disable="true" mnemonicParsing="false" onAction="#onSyncGoogleTechnicien" style="-fx-background-color: #4285f4; -fx-text-fill: white;" text="ðŸ”„ Sync Google" />
                              <Region HBox.hgrow="ALWAYS" />
                              <Button fx:id="btnVoirStatsTechnicien" disable="true" mnemonicParsing="false" onAction="#onVoirStatsTechnicien" text="ðŸ“Š Statistiques" />
                           </children>
                        </HBox>
                     </children>
                     <padding>
                        <Insets bottom="10.0" left="10.0" right="10.0" top="10.0" />
                     </padding>
                  </VBox>
               </content>
            </Tab>
            
            <!-- Onglet Configuration Google -->
            <Tab text="ðŸ”§ Configuration Google">
               <content>
                  <ScrollPane fitToWidth="true">
                     <content>
                        <VBox spacing="20.0">
                           <children>
                              <Label text="Configuration des Services Google">
                                 <font>
                                    <Font name="System Bold" size="18.0" />
                                 </font>
                              </Label>
                              
                              <!-- Statut de connexion -->
                              <VBox spacing="10.0" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 5; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                                 <children>
                                    <Label text="Statut de la Connexion">
                                       <font>
                                          <Font name="System Bold" size="14.0" />
                                       </font>
                                    </Label>
                                    <GridPane fx:id="gridStatutGoogle" hgap="15.0" vgap="10.0" />
                                 </children>
                              </VBox>
                              
                              <!-- Configuration OAuth -->
                              <VBox spacing="10.0" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 5; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                                 <children>
                                    <Label text="Configuration OAuth 2.0">
                                       <font>
                                          <Font name="System Bold" size="14.0" />
                                       </font>
                                    </Label>
                                    <Button fx:id="btnConfigurerOAuth" mnemonicParsing="false" onAction="#onConfigurerOAuth" style="-fx-background-color: #4285f4; -fx-text-fill: white;" text="ðŸ” Configurer OAuth" />
                                    <Label fx:id="lblStatutOAuth" text="Non configurÃ©" textFill="#dc3545" />
                                 </children>
                              </VBox>
                              
                              <!-- Synchronisation -->
                              <VBox spacing="10.0" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 5; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                                 <children>
                                    <Label text="Synchronisation">
                                       <font>
                                          <Font name="System Bold" size="14.0" />
                                       </font>
                                    </Label>
                                    
                                    <CheckBox fx:id="cbSyncAutoGoogle" mnemonicParsing="false" text="Synchronisation automatique" />
                                    <CheckBox fx:id="cbSyncCalendar" mnemonicParsing="false" text="Synchroniser avec Google Calendar" />
                                    <CheckBox fx:id="cbSyncContacts" mnemonicParsing="false" text="Synchroniser avec Google Contacts" />
                                    <CheckBox fx:id="cbSyncGmail" mnemonicParsing="false" text="Envoyer emails via Gmail" />
                                    
                                    <HBox spacing="10.0">
                                       <children>
                                          <Button fx:id="btnSyncManuelle" mnemonicParsing="false" onAction="#onSyncManuelle" text="ðŸ”„ Synchronisation Manuelle" />
                                          <Button fx:id="btnTesterConnexion" mnemonicParsing="false" onAction="#onTesterConnexion" text="ðŸ§ª Tester Connexion" />
                                       </children>
                                    </HBox>
                                 </children>
                              </VBox>
                              
                              <!-- Historique -->
                              <VBox spacing="10.0" style="-fx-background-color: white; -fx-padding: 15; -fx-background-radius: 5; -fx-effect: dropshadow(gaussian, rgba(0,0,0,0.1), 5, 0, 0, 2);">
                                 <children>
                                    <Label text="Historique de Synchronisation">
                                       <font>
                                          <Font name="System Bold" size="14.0" />
                                       </font>
                                    </Label>
                                    <TableView fx:id="tableHistoriqueSync" prefHeight="200.0">
                                       <columns>
                                          <TableColumn fx:id="colSyncDate" prefWidth="150.0" text="Date" />
                                          <TableColumn fx:id="colSyncService" prefWidth="120.0" text="Service" />
                                          <TableColumn fx:id="colSyncStatut" prefWidth="100.0" text="Statut" />
                                          <TableColumn fx:id="colSyncElements" prefWidth="100.0" text="Ã‰lÃ©ments" />
                                          <TableColumn fx:id="colSyncMessage" prefWidth="200.0" text="Message" />
                                       </columns>
                                    </TableView>
                                 </children>
                              </VBox>
                           </children>
                           <padding>
                              <Insets bottom="20.0" left="20.0" right="20.0" top="20.0" />
                           </padding>
                        </VBox>
                     </content>
                  </ScrollPane>
               </content>
            </Tab>
         </tabs>
      </TabPane>
   </center>
   
   <bottom>
      <HBox alignment="CENTER_LEFT" spacing="10.0" style="-fx-background-color: #f8f9fa; -fx-border-color: #dee2e6; -fx-border-width: 1 0 0 0;">
         <children>
            <Label fx:id="lblStatusPlanning" text="PrÃªt" textFill="#6c757d" />
            <Region HBox.hgrow="ALWAYS" />
            <Label fx:id="lblDerniereSyncGoogle" text="DerniÃ¨re sync Google: Jamais" textFill="#6c757d" />
            <Separator orientation="VERTICAL" />
            <Label fx:id="lblNombreInterventions" text="0 intervention(s)" textFill="#6c757d" />
         </children>
         <padding>
            <Insets bottom="5.0" left="10.0" right="10.0" top="5.0" />
         </padding>
      </HBox>
   </bottom>
</BorderPane>